let data = [{
    id: "bitcoin",
    name: "Bitcoin",
    symbol: "BTC",
    rank: "1",
    price_usd: "6830.38",
    price_btc: "1.0",
    market_cap_usd: "117053840860",
    available_supply: "17137237.0",
    total_supply: "17137237.0",
    max_supply: "21000000.0",
    percent_change_1h: "0.08",
    percent_change_24h: "2.76",
    percent_change_7d: "7.09",
    last_updated: "1531029315"
  },
  {
    id: "ethereum",
    name: "Ethereum",
    symbol: "ETH",
    rank: "2",
    price_usd: "493.618",
    price_btc: "0.0733422",
    market_cap_usd: "49635857793.0",
    available_supply: "100555202.0",
    total_supply: "100555202.0",
    max_supply: null,
    percent_change_1h: "0.27",
    percent_change_24h: "4.4",
    percent_change_7d: "8.73",
    last_updated: "1531029313"
  },
  {
    id: "ripple",
    name: "XRP",
    symbol: "XRP",
    rank: "3",
    price_usd: "0.490227",
    price_btc: "0.00007284",
    market_cap_usd: "19247510486.0",
    available_supply: "39262444717.0",
    total_supply: "99991916481.0",
    max_supply: "100000000000",
    percent_change_1h: "-0.15",
    percent_change_24h: "3.18",
    percent_change_7d: "6.89",
    last_updated: "1531029302"
  },
  {
    id: "bitcoin-cash",
    name: "Bitcoin Cash",
    symbol: "BCH",
    rank: "4",
    price_usd: "773.087",
    price_btc: "0.114866",
    market_cap_usd: "13316713483.0",
    available_supply: "17225375.0",
    total_supply: "17225375.0",
    max_supply: "21000000.0",
    percent_change_1h: "0.65",
    percent_change_24h: "5.46",
    percent_change_7d: "4.7",
    last_updated: "1531029315"
  },
  {
    id: "eos",
    name: "EOS",
    symbol: "EOS",
    rank: "5",
    price_usd: "9.02347",
    price_btc: "0.00134071",
    market_cap_usd: "8086378058.0",
    available_supply: "896149492.0",
    total_supply: "900000000.0",
    max_supply: "1000000000.0",
    percent_change_1h: "0.07",
    percent_change_24h: "4.03",
    percent_change_7d: "12.13",
    last_updated: "1531029314"
  },
  {
    id: "litecoin",
    name: "Litecoin",
    symbol: "LTC",
    rank: "6",
    price_usd: "85.1305",
    price_btc: "0.0126488",
    market_cap_usd: "4878737095.0",
    available_supply: "57308921.0",
    total_supply: "57308921.0",
    max_supply: "84000000.0",
    percent_change_1h: "-0.38",
    percent_change_24h: "2.14",
    percent_change_7d: "6.01",
    last_updated: "1531029301"
  },
  {
    id: "stellar",
    name: "Stellar",
    symbol: "XLM",
    rank: "7",
    price_usd: "0.211038",
    price_btc: "0.00003136",
    market_cap_usd: "3960224302.0",
    available_supply: "18765455992.0",
    total_supply: "104085355272",
    max_supply: null,
    percent_change_1h: "0.59",
    percent_change_24h: "1.9",
    percent_change_7d: "8.63",
    last_updated: "1531029306"
  },
  {
    id: "cardano",
    name: "Cardano",
    symbol: "ADA",
    rank: "8",
    price_usd: "0.148949",
    price_btc: "0.00002213",
    market_cap_usd: "3861811230.0",
    available_supply: "25927070538.0",
    total_supply: "31112483745.0",
    max_supply: "45000000000.0",
    percent_change_1h: "0.12",
    percent_change_24h: "3.76",
    percent_change_7d: "8.95",
    last_updated: "1531029326"
  },
  {
    id: "iota",
    name: "IOTA",
    symbol: "MIOTA",
    rank: "9",
    price_usd: "1.11396",
    price_btc: "0.00016551",
    market_cap_usd: "3096285554.0",
    available_supply: "2779530283.0",
    total_supply: "2779530283.0",
    max_supply: "2779530283.0",
    percent_change_1h: "0.46",
    percent_change_24h: "3.27",
    percent_change_7d: "9.3",
    last_updated: "1531029314"
  },
  {
    id: "neo",
    name: "NEO",
    symbol: "NEO",
    rank: "10",
    price_usd: "41.1367",
    price_btc: "0.00611213",
    market_cap_usd: "2673885500.0",
    available_supply: "65000000.0",
    total_supply: "100000000.0",
    max_supply: "100000000.0",
    percent_change_1h: "1.96",
    percent_change_24h: "10.43",
    percent_change_7d: "35.25",
    last_updated: "1531029311"
  },
  {
    id: "tether",
    name: "Tether",
    symbol: "USDT",
    rank: "11",
    price_usd: "1.00637",
    price_btc: "0.00014953",
    market_cap_usd: "2623747830.0",
    available_supply: "2607140346.0",
    total_supply: "3080109502.0",
    max_supply: null,
    percent_change_1h: "-0.02",
    percent_change_24h: "0.4",
    percent_change_7d: "0.71",
    last_updated: "1531029306"
  },
  {
    id: "tron",
    name: "TRON",
    symbol: "TRX",
    rank: "12",
    price_usd: "0.0380127",
    price_btc: "0.00000565",
    market_cap_usd: "2499263244.0",
    available_supply: "65748111645.0",
    total_supply: "100000000000",
    max_supply: null,
    percent_change_1h: "0.14",
    percent_change_24h: "4.2",
    percent_change_7d: "1.01",
    last_updated: "1531029314"
  },
  {
    id: "monero",
    name: "Monero",
    symbol: "XMR",
    rank: "13",
    price_usd: "136.294",
    price_btc: "0.0202507",
    market_cap_usd: "2208574441.0",
    available_supply: "16204488.0",
    total_supply: "16204488.0",
    max_supply: null,
    percent_change_1h: "0.44",
    percent_change_24h: "1.93",
    percent_change_7d: "4.22",
    last_updated: "1531029306"
  },
  {
    id: "dash",
    name: "Dash",
    symbol: "DASH",
    rank: "14",
    price_usd: "245.723",
    price_btc: "0.0365098",
    market_cap_usd: "2010613083.0",
    available_supply: "8182437.0",
    total_supply: "8182437.0",
    max_supply: "18900000.0",
    percent_change_1h: "0.19",
    percent_change_24h: "1.81",
    percent_change_7d: "4.26",
    last_updated: "1531029302"
  },
  {
    id: "ethereum-classic",
    name: "Ethereum Classic",
    symbol: "ETC",
    rank: "15",
    price_usd: "18.9767",
    price_btc: "0.00281957",
    market_cap_usd: "1952045552.0",
    available_supply: "102865385.0",
    total_supply: "102865385.0",
    max_supply: null,
    percent_change_1h: "0.54",
    percent_change_24h: "3.48",
    percent_change_7d: "18.99",
    last_updated: "1531029307"
  },
  {
    id: "nem",
    name: "NEM",
    symbol: "XEM",
    rank: "16",
    price_usd: "0.186682",
    price_btc: "0.00002774",
    market_cap_usd: "1680138000.0",
    available_supply: "8999999999.0",
    total_supply: "8999999999.0",
    max_supply: null,
    percent_change_1h: "-0.08",
    percent_change_24h: "0.36",
    percent_change_7d: "14.3",
    last_updated: "1531029306"
  },
  {
    id: "binance-coin",
    name: "Binance Coin",
    symbol: "BNB",
    rank: "17",
    price_usd: "14.3233",
    price_btc: "0.00212817",
    market_cap_usd: "1633447611.0",
    available_supply: "114041290.0",
    total_supply: "194972068.0",
    max_supply: null,
    percent_change_1h: "-0.28",
    percent_change_24h: "3.2",
    percent_change_7d: "-0.92",
    last_updated: "1531029314"
  },
  {
    id: "vechain",
    name: "VeChain",
    symbol: "VEN",
    rank: "18",
    price_usd: "2.57263",
    price_btc: "0.00038224",
    market_cap_usd: "1420523142.0",
    available_supply: "552167681.0",
    total_supply: "873378637.0",
    max_supply: null,
    percent_change_1h: "0.02",
    percent_change_24h: "4.17",
    percent_change_7d: "-2.0",
    last_updated: "1531029318"
  },
  {
    id: "tezos",
    name: "Tezos",
    symbol: "XTZ",
    rank: "19",
    price_usd: "2.24997",
    price_btc: "0.0003343",
    market_cap_usd: "1366832117.0",
    available_supply: "607489041.0",
    total_supply: "763306930.0",
    max_supply: null,
    percent_change_1h: "7.03",
    percent_change_24h: "30.86",
    percent_change_7d: "-48.1",
    last_updated: "1531029318"
  },
  {
    id: "omisego",
    name: "OmiseGO",
    symbol: "OMG",
    rank: "20",
    price_usd: "8.19652",
    price_btc: "0.00121785",
    market_cap_usd: "836393816.0",
    available_supply: "102042552.0",
    total_supply: "140245398.0",
    max_supply: null,
    percent_change_1h: "0.34",
    percent_change_24h: "2.68",
    percent_change_7d: "2.82",
    last_updated: "1531029314"
  },
  {
    id: "qtum",
    name: "Qtum",
    symbol: "QTUM",
    rank: "21",
    price_usd: "9.22542",
    price_btc: "0.00137072",
    market_cap_usd: "817967399.0",
    available_supply: "88664516.0",
    total_supply: "100664516.0",
    max_supply: null,
    percent_change_1h: "-0.6",
    percent_change_24h: "-0.48",
    percent_change_7d: "7.75",
    last_updated: "1531029315"
  },
  {
    id: "zcash",
    name: "Zcash",
    symbol: "ZEC",
    rank: "22",
    price_usd: "175.325",
    price_btc: "0.0260499",
    market_cap_usd: "754946163.0",
    available_supply: "4305981.0",
    total_supply: "4305981.0",
    max_supply: null,
    percent_change_1h: "-0.44",
    percent_change_24h: "-0.08",
    percent_change_7d: "5.57",
    last_updated: "1531029310"
  },
  {
    id: "ontology",
    name: "Ontology",
    symbol: "ONT",
    rank: "23",
    price_usd: "4.71691",
    price_btc: "0.00070084",
    market_cap_usd: "713631573.0",
    available_supply: "151292175.0",
    total_supply: "1000000000.0",
    max_supply: null,
    percent_change_1h: "0.22",
    percent_change_24h: "1.25",
    percent_change_7d: "-8.58",
    last_updated: "1531029326"
  },
  {
    id: "icon",
    name: "ICON",
    symbol: "ICX",
    rank: "24",
    price_usd: "1.69981",
    price_btc: "0.00025256",
    market_cap_usd: "658559666.0",
    available_supply: "387431340.0",
    total_supply: "400228740.0",
    max_supply: null,
    percent_change_1h: "-0.13",
    percent_change_24h: "0.96",
    percent_change_7d: "5.03",
    last_updated: "1531029318"
  },
  {
    id: "zilliqa",
    name: "Zilliqa",
    symbol: "ZIL",
    rank: "25",
    price_usd: "0.085807",
    price_btc: "0.00001275",
    market_cap_usd: "650086141.0",
    available_supply: "7576143444.0",
    total_supply: "12600000000.0",
    max_supply: null,
    percent_change_1h: "0.77",
    percent_change_24h: "3.91",
    percent_change_7d: "19.52",
    last_updated: "1531029323"
  },
  {
    id: "lisk",
    name: "Lisk",
    symbol: "LSK",
    rank: "26",
    price_usd: "5.62616",
    price_btc: "0.00083594",
    market_cap_usd: "606233819.0",
    available_supply: "107752680.0",
    total_supply: "122999128.0",
    max_supply: null,
    percent_change_1h: "0.42",
    percent_change_24h: "0.18",
    percent_change_7d: "4.53",
    last_updated: "1531029310"
  },
  {
    id: "bytecoin-bcn",
    name: "Bytecoin",
    symbol: "BCN",
    rank: "27",
    price_usd: "0.00318906",
    price_btc: "0.00000047",
    market_cap_usd: "586437778.0",
    available_supply: "183890481254",
    total_supply: "183890481254",
    max_supply: "184470000000",
    percent_change_1h: "-0.51",
    percent_change_24h: "-1.42",
    percent_change_7d: "7.51",
    last_updated: "1531029306"
  },
  {
    id: "0x",
    name: "0x",
    symbol: "ZRX",
    rank: "28",
    price_usd: "0.98548",
    price_btc: "0.00014642",
    market_cap_usd: "525722536.0",
    available_supply: "533468499.0",
    total_supply: "1000000000.0",
    max_supply: null,
    percent_change_1h: "1.16",
    percent_change_24h: "0.34",
    percent_change_7d: "28.61",
    last_updated: "1531029315"
  },
  {
    id: "bitcoin-gold",
    name: "Bitcoin Gold",
    symbol: "BTG",
    rank: "29",
    price_usd: "30.7187",
    price_btc: "0.0045642",
    market_cap_usd: "525623025.0",
    available_supply: "17110849.0",
    total_supply: "17210849.0",
    max_supply: "21000000.0",
    percent_change_1h: "0.78",
    percent_change_24h: "4.11",
    percent_change_7d: "17.54",
    last_updated: "1531029318"
  },
  {
    id: "aeternity",
    name: "Aeternity",
    symbol: "AE",
    rank: "30",
    price_usd: "2.17628",
    price_btc: "0.00032335",
    market_cap_usd: "507117793.0",
    available_supply: "233020472.0",
    total_supply: "273685830.0",
    max_supply: null,
    percent_change_1h: "0.21",
    percent_change_24h: "2.42",
    percent_change_7d: "12.48",
    last_updated: "1531029314"
  }
]

// FP utilities
let _ = require('lodash')
let pipe = require('lodash/fp/pipe');

// Stub to resolve with data
let getPrices = () => Promise.resolve({data})

// Use destructuring in the param, not much change with original
// Note: we could separate this out further with _.pick and _.setWith but it would be overkill
// ES6 destructuring already makes our lives easier to pick the properties we want
let parseTicker = ({symbol,price_usd,market_cap_usd,percent_change_24h,percent_change_7d}) => {
  return Object.assign({}, {
    ticker: symbol,
    currency: "USD",
    price: Number(price_usd),
    mktcap: Number(market_cap_usd),
    changePctDay: Number(percent_change_24h) / 100,
    changePctWeek: Number(percent_change_7d) / 100
  })
}

// Similar to original but more declarative using pipe to say that when we receive the array we will pipe it via 2 functions:
// 1. map it and then parse the tickers
// 2. sort it by marketcap descending
let parseTickers = pipe(
  _.partialRight(_.map, parseTicker),
  _.partialRight(_.orderBy, 'desc', 'mktcap')
)

// Then we wrap ths into one promise function which calls the API and when resolves will use the pipe parseTicker function
let fetchTickers = () => getPrices().then(data => parseTickers(data.data))

// Use case
// fetchTickers().then(data => {
//   data
// })
